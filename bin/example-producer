#!/usr/bin/env ruby

$LOAD_PATH.unshift File.expand_path(File.join(File.dirname(__FILE__), "../lib"))

require "pulsar/client"

client = Pulsar::Client.new(ENV['PULSAR_BROKER_URI'], {
  use_tls: true,
  tls_allow_insecure_connection: true,
  tls_validate_hostname: false,
  authentication_token: ENV['PULSAR_AUTH_TOKEN']
})

producer = client.create_producer('persistent://dnd/demigorgon/another-example-topic')
while data = gets
  data.chomp!
  producer.send(data)
  break if data == "exit"
end
client.close
