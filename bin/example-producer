#!/usr/bin/env ruby

$LOAD_PATH.unshift File.expand_path(File.join(File.dirname(__FILE__), "../lib"))

require "pulsar/client"

client = Pulsar::Client.from_environment
producer = client.create_producer('persistent://dnd/demigorgon/example-topic')
while data = gets
  data.chomp!
  producer.send(data)
  break if data == "exit"
end
client.close
